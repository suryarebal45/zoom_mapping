_____________________________________________
## *Author*: AAVA
## *Created on*:   
## *Description*:   Gold layer Fact table data mapping for Zoom Platform Analytics Systems: Silver to Gold transformation, aggregation, validation, and cleansing rules for all Fact tables
## *Version*: 1 
## *Updated on*: 
_____________________________________________

# 1. Overview

This document details the data mapping approach for transforming Silver layer fact data into Gold layer fact tables for the Zoom Platform Analytics Systems. The mapping ensures:

1. High performance and scalability via Snowflake-optimized SQL (CTEs, window functions, clustering keys)
2. Consistency and traceability of business metrics (meeting utilization, engagement, quality, billing, usage)
3. Robust data validation and cleansing (data quality scoring, deduplication, safe type conversion, error handling)
4. Accurate fact-dimension relationships for analytical reporting

**Snowflake-specific notes:**
- Clustering keys are defined on frequently queried columns for partition pruning
- CTEs and QUALIFY are used for staging and deduplication
- TRY_CAST, TRY_TO_DATE, and COALESCE are used for safe conversions and missing value handling
- Incremental loads are supported via MERGE and update_timestamp logic

# 2. Data Mapping for Fact Tables

Below is the detailed mapping for each Gold layer Fact table, showing source-to-target field relationships, aggregation, validation, and transformation rules.

---

## 2.1 Go_Meeting_Facts

| # | Target Layer | Target Table         | Target Field                  | Source Layer | Source Table      | Source Field                | Aggregation Rule         | Validation Rule                                                                 | Transformation Rule                                                                                                    |
|---|--------------|---------------------|-------------------------------|--------------|-------------------|-----------------------------|--------------------------|----------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| 1 | Gold         | Go_Meeting_Facts    | meeting_fact_id               | Gold         | (generated)       | (generated)                 | ROW_NUMBER() OVER (...)  | Unique, not null                                                                  | ROW_NUMBER() OVER (ORDER BY meeting_id) AS meeting_fact_id                                                            |
| 2 | Gold         | Go_Meeting_Facts    | meeting_id                    | Silver       | sv_meetings       | meeting_id                  | None                     | NOT NULL, must exist in Silver                                                    | Direct mapping                                                                                                         |
| 3 | Gold         | Go_Meeting_Facts    | host_id                       | Silver       | sv_meetings       | host_id                     | None                     | NOT NULL, must exist in Silver                                                    | Direct mapping                                                                                                         |
| 4 | Gold         | Go_Meeting_Facts    | meeting_topic                 | Silver       | sv_meetings       | meeting_topic               | None                     | NULL allowed                                                                      | Direct mapping                                                                                                         |
| 5 | Gold         | Go_Meeting_Facts    | start_time                    | Silver       | sv_meetings       | start_time                  | None                     | NOT NULL, must precede end_time                                                   | Direct mapping                                                                                                         |
| 6 | Gold         | Go_Meeting_Facts    | end_time                      | Silver       | sv_meetings       | end_time                    | None                     | NOT NULL, must follow start_time                                                  | Direct mapping                                                                                                         |
| 7 | Gold         | Go_Meeting_Facts    | duration_minutes              | Silver       | sv_meetings       | duration_minutes            | CASE/validation          | Must match DATEDIFF('minute', start_time, end_time) Â±1 second                    | See transformation: CASE WHEN DATEDIFF('second', start_time, end_time) != (duration_minutes * 60) THEN ...            |
| 8 | Gold         | Go_Meeting_Facts    | participant_count             | Silver       | sv_participants   | participant_id              | COUNT(DISTINCT)          | >0 for valid meetings                                                             | COUNT(DISTINCT participant_id) GROUP BY meeting_id                                                                     |
| 9 | Gold         | Go_Meeting_Facts    | max_concurrent_participants   | Silver       | sv_participants   | join_time/leave_time        | MAX(window)              | >0 for valid meetings                                                             | See transformation: window SUM(event_type) OVER (PARTITION BY meeting_id ORDER BY event_time)                          |
|10 | Gold         | Go_Meeting_Facts    | total_attendance_minutes      | Silver       | sv_participants   | join_time, leave_time       | SUM(DATEDIFF)            | >=0                                                                                | SUM(DATEDIFF('second', join_time, leave_time))/60.0 GROUP BY meeting_id                                                |
|11 | Gold         | Go_Meeting_Facts    | average_attendance_duration   | Silver       | sv_participants   | join_time, leave_time       | AVG(DATEDIFF)            | >=0                                                                                | AVG(DATEDIFF('second', join_time, leave_time))/60.0 GROUP BY meeting_id                                                |
|12 | Gold         | Go_Meeting_Facts    | meeting_type                  | Gold         | (derived)         | (derived)                   | None                     | NULL allowed                                                                      | Derived from meeting_topic or other logic                                                                              |
|13 | Gold         | Go_Meeting_Facts    | meeting_status                | Gold         | (derived)         | (derived)                   | None                     | NULL allowed                                                                      | Derived from record_status or other logic                                                                              |
|14 | Gold         | Go_Meeting_Facts    | recording_enabled             | Gold         | (derived)         | (derived)                   | None                     | NULL allowed                                                                      | Derived from feature usage or meeting settings                                                                         |
|15 | Gold         | Go_Meeting_Facts    | screen_share_count            | Silver       | sv_feature_usage  | feature_name/usage_count    | SUM WHERE feature_name='ScreenShare' | >=0                                 | SUM(usage_count) WHERE feature_name='ScreenShare' GROUP BY meeting_id                                                  |
|16 | Gold         | Go_Meeting_Facts    | chat_message_count            | Silver       | sv_feature_usage  | feature_name/usage_count    | SUM WHERE feature_name='Chat'        | >=0                                 | SUM(usage_count) WHERE feature_name='Chat' GROUP BY meeting_id                                                         |
|17 | Gold         | Go_Meeting_Facts    | breakout_room_count           | Silver       | sv_feature_usage  | feature_name/usage_count    | SUM WHERE feature_name='BreakoutRoom' | >=0                              | SUM(usage_count) WHERE feature_name='BreakoutRoom' GROUP BY meeting_id                                                 |
|18 | Gold         | Go_Meeting_Facts    | quality_score_avg             | Gold         | Go_Quality_Facts  | quality metrics             | AVG                       | >=0, <=100                                                                         | AVG(audio_quality_score, video_quality_score, connection_stability_rating) GROUP BY meeting_id                         |
|19 | Gold         | Go_Meeting_Facts    | engagement_score              | Silver       | sv_meetings, sv_participants, sv_feature_usage | (derived) | See transformation | See engagement score CTE and calculation in recommendations                                                             |
|20 | Gold         | Go_Meeting_Facts    | load_date                     | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|21 | Gold         | Go_Meeting_Facts    | update_date                   | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|22 | Gold         | Go_Meeting_Facts    | source_system                 | Silver       | sv_meetings       | source_system               | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |

**Explanations:**
- Duration, participant, and engagement metrics use CTEs and window functions for accuracy and deduplication
- Data quality enforced via CASE and validation flags
- All aggregations use Snowflake SQL syntax

---

## 2.2 Go_Participant_Facts

| # | Target Layer | Target Table         | Target Field                  | Source Layer | Source Table      | Source Field                | Aggregation Rule         | Validation Rule                                                                 | Transformation Rule                                                                                                    |
|---|--------------|---------------------|-------------------------------|--------------|-------------------|-----------------------------|--------------------------|----------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| 1 | Gold         | Go_Participant_Facts| participant_fact_id           | Gold         | (generated)       | (generated)                 | ROW_NUMBER() OVER (...)  | Unique, not null                                                                  | ROW_NUMBER() OVER (ORDER BY meeting_id, participant_id) AS participant_fact_id                                         |
| 2 | Gold         | Go_Participant_Facts| meeting_id                    | Silver       | sv_participants   | meeting_id                  | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 3 | Gold         | Go_Participant_Facts| participant_id                | Silver       | sv_participants   | participant_id              | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 4 | Gold         | Go_Participant_Facts| user_id                       | Silver       | sv_participants   | user_id                     | None                     | NULL allowed                                                                       | Direct mapping                                                                                                         |
| 5 | Gold         | Go_Participant_Facts| join_time                     | Silver       | sv_participants   | join_time                   | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 6 | Gold         | Go_Participant_Facts| leave_time                    | Silver       | sv_participants   | leave_time                  | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 7 | Gold         | Go_Participant_Facts| attendance_duration           | Silver       | sv_participants   | join_time, leave_time       | DATEDIFF('second', join_time, leave_time)/60.0 | >=0, leave_time >= join_time | See transformation: DATEDIFF('second', join_time, leave_time)/60.0                                                    |
| 8 | Gold         | Go_Participant_Facts| participant_role              | Gold         | (derived)         | (derived)                   | None                     | NULL allowed                                                                       | CASE WHEN ROW_NUMBER() OVER (PARTITION BY meeting_id ORDER BY join_time) = 1 THEN 'HOST' ELSE 'PARTICIPANT' END        |
| 9 | Gold         | Go_Participant_Facts| audio_connection_type         | Gold         | (derived)         | (derived)                   | None                     | NULL allowed                                                                       | Derived from feature usage or connection logs                                                                          |
|10 | Gold         | Go_Participant_Facts| video_enabled                 | Gold         | (derived)         | (derived)                   | None                     | NULL allowed                                                                       | Derived from feature usage or connection logs                                                                          |
|11 | Gold         | Go_Participant_Facts| screen_share_duration         | Silver       | sv_feature_usage  | feature_name/usage_count    | SUM WHERE feature_name='ScreenShare' | >=0                                 | SUM(usage_count) WHERE feature_name='ScreenShare' GROUP BY meeting_id, participant_id                                  |
|12 | Gold         | Go_Participant_Facts| chat_messages_sent            | Silver       | sv_feature_usage  | feature_name/usage_count    | SUM WHERE feature_name='Chat'        | >=0                                 | SUM(usage_count) WHERE feature_name='Chat' GROUP BY meeting_id, participant_id                                         |
|13 | Gold         | Go_Participant_Facts| interaction_count             | Silver       | sv_feature_usage  | usage_count                 | SUM                       | >=0                                                                                | SUM(usage_count) GROUP BY meeting_id, participant_id                                                                   |
|14 | Gold         | Go_Participant_Facts| connection_quality_rating     | Gold         | Go_Quality_Facts  | connection_stability_rating | AVG                       | >=0, <=100                                                                         | AVG(connection_stability_rating) GROUP BY meeting_id, participant_id                                                   |
|15 | Gold         | Go_Participant_Facts| device_type                   | Gold         | (derived)         | (derived)                   | None                     | NULL allowed                                                                       | Derived from device logs or feature usage                                                                              |
|16 | Gold         | Go_Participant_Facts| geographic_location           | Gold         | (derived)         | (derived)                   | None                     | NULL allowed                                                                       | Derived from IP/location logs                                                                                          |
|17 | Gold         | Go_Participant_Facts| load_date                     | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|18 | Gold         | Go_Participant_Facts| update_date                   | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|19 | Gold         | Go_Participant_Facts| source_system                 | Silver       | sv_participants   | source_system               | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |

**Explanations:**
- Attendance duration and participant role are derived using window functions
- Data quality enforced via CASE and validation flags
- All aggregations use Snowflake SQL syntax

---

## 2.3 Go_Webinar_Facts

| # | Target Layer | Target Table         | Target Field                  | Source Layer | Source Table      | Source Field                | Aggregation Rule         | Validation Rule                                                                 | Transformation Rule                                                                                                    |
|---|--------------|---------------------|-------------------------------|--------------|-------------------|-----------------------------|--------------------------|----------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| 1 | Gold         | Go_Webinar_Facts    | webinar_fact_id               | Gold         | (generated)       | (generated)                 | ROW_NUMBER() OVER (...)  | Unique, not null                                                                  | ROW_NUMBER() OVER (ORDER BY webinar_id) AS webinar_fact_id                                                            |
| 2 | Gold         | Go_Webinar_Facts    | webinar_id                    | Silver       | sv_webinars       | webinar_id                  | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 3 | Gold         | Go_Webinar_Facts    | host_id                       | Silver       | sv_webinars       | host_id                     | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 4 | Gold         | Go_Webinar_Facts    | webinar_topic                 | Silver       | sv_webinars       | webinar_topic               | None                     | NULL allowed                                                                       | Direct mapping                                                                                                         |
| 5 | Gold         | Go_Webinar_Facts    | start_time                    | Silver       | sv_webinars       | start_time                  | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 6 | Gold         | Go_Webinar_Facts    | end_time                      | Silver       | sv_webinars       | end_time                    | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 7 | Gold         | Go_Webinar_Facts    | duration_minutes              | Silver       | sv_webinars       | start_time, end_time        | DATEDIFF('minute', start_time, end_time) | >=0                                 | DATEDIFF('minute', start_time, end_time)                                                                              |
| 8 | Gold         | Go_Webinar_Facts    | registrants_count             | Silver       | sv_webinars       | registrants                 | None                     | >=0                                                                                | Direct mapping                                                                                                         |
| 9 | Gold         | Go_Webinar_Facts    | actual_attendees              | Silver       | sv_participants   | participant_id              | COUNT(DISTINCT)          | >=0                                                                                | COUNT(DISTINCT participant_id) WHERE meeting_id = webinar_id                                                           |
|10 | Gold         | Go_Webinar_Facts    | attendance_rate               | Gold         | (derived)         | (derived)                   | CASE                     | >=0, <=100                                                                         | CASE WHEN registrants > 0 THEN ROUND((actual_attendees::FLOAT / registrants) * 100, 2) ELSE 0 END                     |
|11 | Gold         | Go_Webinar_Facts    | max_concurrent_attendees      | Silver       | sv_participants   | join_time/leave_time        | MAX(window)              | >=0                                                                                | See transformation: window SUM(event_type) OVER (PARTITION BY meeting_id ORDER BY event_time)                          |
|12 | Gold         | Go_Webinar_Facts    | qa_questions_count            | Gold         | (default)         | (default)                   | 0                        | >=0                                                                                | 0                                                                                                                      |
|13 | Gold         | Go_Webinar_Facts    | poll_responses_count          | Gold         | (default)         | (default)                   | 0                        | >=0                                                                                | 0                                                                                                                      |
|14 | Gold         | Go_Webinar_Facts    | engagement_score              | Gold         | (derived)         | (derived)                   | CASE                     | >=0, <=100                                                                         | See transformation: attendance rate + duration-based score                                                             |
|15 | Gold         | Go_Webinar_Facts    | event_category                | Gold         | (default)         | (default)                   | 'WEBINAR'                | Not null                                                                           | 'WEBINAR'                                                                                                              |
|16 | Gold         | Go_Webinar_Facts    | load_date                     | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|17 | Gold         | Go_Webinar_Facts    | update_date                   | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|18 | Gold         | Go_Webinar_Facts    | source_system                 | Silver       | sv_webinars       | source_system               | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |

**Explanations:**
- Attendance rate and engagement score are derived from registrants and actual attendees
- Data quality enforced via CASE and validation flags
- All aggregations use Snowflake SQL syntax

---

## 2.4 Go_Billing_Facts

| # | Target Layer | Target Table         | Target Field                  | Source Layer | Source Table      | Source Field                | Aggregation Rule         | Validation Rule                                                                 | Transformation Rule                                                                                                    |
|---|--------------|---------------------|-------------------------------|--------------|-------------------|-----------------------------|--------------------------|----------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| 1 | Gold         | Go_Billing_Facts    | billing_fact_id               | Gold         | (generated)       | (generated)                 | ROW_NUMBER() OVER (...)  | Unique, not null                                                                  | ROW_NUMBER() OVER (ORDER BY event_id) AS billing_fact_id                                                              |
| 2 | Gold         | Go_Billing_Facts    | event_id                      | Silver       | sv_billing_events | event_id                    | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 3 | Gold         | Go_Billing_Facts    | user_id                       | Silver       | sv_billing_events | user_id                     | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 4 | Gold         | Go_Billing_Facts    | organization_id               | Gold         | (default)         | (default)                   | NULL                     | NULL allowed                                                                       | NULL                                                                                                                   |
| 5 | Gold         | Go_Billing_Facts    | event_type                    | Silver       | sv_billing_events | event_type                  | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 6 | Gold         | Go_Billing_Facts    | amount                        | Silver       | sv_billing_events | amount                      | ROUND(amount, 2)         | >=0, NOT NULL                                                                       | ROUND(amount, 2)                                                                                                      |
| 7 | Gold         | Go_Billing_Facts    | event_date                    | Silver       | sv_billing_events | event_date                  | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 8 | Gold         | Go_Billing_Facts    | billing_period_start          | Gold         | (derived)         | (derived)                   | CASE                     | NOT NULL                                                                           | CASE WHEN event_type IN ('Subscription Fee', 'Subscription Renewal') THEN DATE_TRUNC('month', event_date) ELSE event_date END |
| 9 | Gold         | Go_Billing_Facts    | billing_period_end            | Gold         | (derived)         | (derived)                   | CASE                     | NOT NULL                                                                           | CASE WHEN event_type IN ('Subscription Fee', 'Subscription Renewal') THEN LAST_DAY(event_date) ELSE event_date END     |
|10 | Gold         | Go_Billing_Facts    | payment_method                | Gold         | (default)         | (default)                   | 'CREDIT_CARD'            | NOT NULL                                                                           | 'CREDIT_CARD'                                                                                                          |
|11 | Gold         | Go_Billing_Facts    | transaction_status            | Gold         | (derived)         | (derived)                   | CASE                     | NOT NULL                                                                           | CASE WHEN amount > 0 AND event_type != 'Refund' THEN 'COMPLETED' WHEN event_type = 'Refund' THEN 'REFUNDED' ELSE 'PENDING' END |
|12 | Gold         | Go_Billing_Facts    | currency_code                 | Gold         | (default)         | (default)                   | 'USD'                    | NOT NULL                                                                           | 'USD'                                                                                                                  |
|13 | Gold         | Go_Billing_Facts    | tax_amount                    | Gold         | (derived)         | (derived)                   | CASE                     | NOT NULL                                                                           | CASE WHEN event_type NOT IN ('Refund') THEN ROUND(amount * 0.08, 2) ELSE ROUND(amount * -0.08, 2) END                  |
|14 | Gold         | Go_Billing_Facts    | discount_amount               | Gold         | (default)         | (default)                   | 0.00                     | NOT NULL                                                                           | 0.00                                                                                                                   |
|15 | Gold         | Go_Billing_Facts    | load_date                     | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|16 | Gold         | Go_Billing_Facts    | update_date                   | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|17 | Gold         | Go_Billing_Facts    | source_system                 | Silver       | sv_billing_events | source_system               | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |

**Explanations:**
- Amount, tax, and billing period fields are standardized and validated
- Data quality enforced via CASE and validation flags
- All aggregations use Snowflake SQL syntax

---

## 2.5 Go_Usage_Facts

| # | Target Layer | Target Table         | Target Field                  | Source Layer | Source Table      | Source Field                | Aggregation Rule         | Validation Rule                                                                 | Transformation Rule                                                                                                    |
|---|--------------|---------------------|-------------------------------|--------------|-------------------|-----------------------------|--------------------------|----------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| 1 | Gold         | Go_Usage_Facts      | usage_fact_id                 | Gold         | (generated)       | (generated)                 | ROW_NUMBER() OVER (...)  | Unique, not null                                                                  | ROW_NUMBER() OVER (ORDER BY user_id, usage_date) AS usage_fact_id                                                     |
| 2 | Gold         | Go_Usage_Facts      | user_id                       | Silver       | sv_meetings, sv_webinars | host_id                | None                     | NOT NULL                                                                           | COALESCE(dmu.user_id, dwu.user_id)                                                                                    |
| 3 | Gold         | Go_Usage_Facts      | organization_id               | Gold         | (default)         | (default)                   | NULL                     | NULL allowed                                                                       | NULL                                                                                                                   |
| 4 | Gold         | Go_Usage_Facts      | usage_date                    | Silver       | sv_meetings, sv_webinars | start_time            | DATE(start_time)         | NOT NULL                                                                           | COALESCE(dmu.usage_date, dwu.usage_date)                                                                              |
| 5 | Gold         | Go_Usage_Facts      | meeting_count                 | Silver       | sv_meetings       | meeting_id                  | COUNT(DISTINCT)          | >=0                                                                                | COALESCE(dmu.meeting_count, 0)                                                                                        |
| 6 | Gold         | Go_Usage_Facts      | total_meeting_minutes         | Silver       | sv_meetings       | duration_minutes            | SUM                      | >=0                                                                                | COALESCE(dmu.total_meeting_minutes, 0)                                                                                |
| 7 | Gold         | Go_Usage_Facts      | webinar_count                 | Silver       | sv_webinars       | webinar_id                  | COUNT(DISTINCT)          | >=0                                                                                | COALESCE(dwu.webinar_count, 0)                                                                                        |
| 8 | Gold         | Go_Usage_Facts      | total_webinar_minutes         | Silver       | sv_webinars       | start_time, end_time        | SUM(DATEDIFF)            | >=0                                                                                | COALESCE(dwu.total_webinar_minutes, 0)                                                                                |
| 9 | Gold         | Go_Usage_Facts      | recording_storage_gb          | Gold         | (default)         | (default)                   | 0.0                      | >=0                                                                                | 0.0                                                                                                                   |
|10 | Gold         | Go_Usage_Facts      | feature_usage_count           | Gold         | (default)         | (default)                   | 0                        | >=0                                                                                | 0                                                                                                                     |
|11 | Gold         | Go_Usage_Facts      | unique_participants_hosted    | Gold         | (default)         | (default)                   | 0                        | >=0                                                                                | 0                                                                                                                     |
|12 | Gold         | Go_Usage_Facts      | load_date                     | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|13 | Gold         | Go_Usage_Facts      | update_date                   | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|14 | Gold         | Go_Usage_Facts      | source_system                 | Silver       | sv_meetings, sv_webinars | source_system         | None                     | NOT NULL                                                                           | COALESCE(dmu.source_system, dwu.source_system)                                                                        |

**Explanations:**
- Usage facts are aggregated daily per user from meetings and webinars
- Data quality enforced via COALESCE and validation flags
- All aggregations use Snowflake SQL syntax

---

## 2.6 Go_Quality_Facts

| # | Target Layer | Target Table         | Target Field                  | Source Layer | Source Table      | Source Field                | Aggregation Rule         | Validation Rule                                                                 | Transformation Rule                                                                                                    |
|---|--------------|---------------------|-------------------------------|--------------|-------------------|-----------------------------|--------------------------|----------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| 1 | Gold         | Go_Quality_Facts    | quality_fact_id               | Gold         | (generated)       | (generated)                 | ROW_NUMBER() OVER (...)  | Unique, not null                                                                  | ROW_NUMBER() OVER (ORDER BY meeting_id, participant_id) AS quality_fact_id                                            |
| 2 | Gold         | Go_Quality_Facts    | meeting_id                    | Silver       | sv_meetings       | meeting_id                  | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 3 | Gold         | Go_Quality_Facts    | participant_id                | Silver       | sv_participants   | participant_id              | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |
| 4 | Gold         | Go_Quality_Facts    | device_connection_id          | Gold         | (default)         | (default)                   | NULL                     | NULL allowed                                                                       | NULL                                                                                                                   |
| 5 | Gold         | Go_Quality_Facts    | audio_quality_score           | Gold         | (derived)         | (derived)                   | CASE                     | >=0, <=100                                                                         | CASE WHEN duration_minutes > 60 THEN 75.0 ELSE 85.0 END                                                               |
| 6 | Gold         | Go_Quality_Facts    | video_quality_score           | Gold         | (derived)         | (derived)                   | CASE                     | >=0, <=100                                                                         | CASE WHEN duration_minutes > 60 THEN 70.0 ELSE 80.0 END                                                               |
| 7 | Gold         | Go_Quality_Facts    | connection_stability_rating   | Gold         | (derived)         | (derived)                   | CASE                     | >=0, <=100                                                                         | CASE WHEN attendance_ratio > 0.9 THEN 90.0 ELSE 65.0 END                                                              |
| 8 | Gold         | Go_Quality_Facts    | latency_ms                    | Gold         | (default)         | (default)                   | 100.0                    | >=0                                                                                | 100.0                                                                                                                  |
| 9 | Gold         | Go_Quality_Facts    | packet_loss_rate              | Gold         | (default)         | (default)                   | 2.5                      | >=0                                                                                | 2.5                                                                                                                    |
|10 | Gold         | Go_Quality_Facts    | bandwidth_utilization         | Gold         | (default)         | (default)                   | 50.0                     | >=0                                                                                | 50.0                                                                                                                   |
|11 | Gold         | Go_Quality_Facts    | cpu_usage_percentage          | Gold         | (default)         | (default)                   | 55.0                     | >=0                                                                                | 55.0                                                                                                                   |
|12 | Gold         | Go_Quality_Facts    | memory_usage_mb               | Gold         | (default)         | (default)                   | 750.0                    | >=0                                                                                | 750.0                                                                                                                  |
|13 | Gold         | Go_Quality_Facts    | load_date                     | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|14 | Gold         | Go_Quality_Facts    | update_date                   | Gold         | (generated)       | (generated)                 | CURRENT_DATE()            | NOT NULL                                                                           | CURRENT_DATE()                                                                                                         |
|15 | Gold         | Go_Quality_Facts    | source_system                 | Silver       | sv_meetings       | source_system               | None                     | NOT NULL                                                                           | Direct mapping                                                                                                         |

**Explanations:**
- Quality metrics are derived from meeting and participant facts
- Data quality enforced via CASE and validation flags
- All aggregations use Snowflake SQL syntax

---

# 3. Additional Notes

1. All transformations are written in Snowflake SQL and leverage CTEs, window functions, and QUALIFY for deduplication.
2. Data validation and cleansing rules are enforced at each step using CASE, COALESCE, and safe type conversion functions.
3. Fact-dimension relationships are established via host_id, user_id, organization_id, and time/date fields as per Gold Layer DDL.
4. Incremental loads are supported using update_timestamp and MERGE patterns.
5. All mapping logic is version-controlled and documented for traceability.
